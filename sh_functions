# LLM Container Functions

function set_docker_share_root_env {
    unset DOCKER_SHARE_ROOT
    export DOCKER_SHARE_ROOT="$(git rev-parse --show-toplevel)" 	
    if [[ -z "$DOCKER_SHARE_ROOT" ]]; then
        export DOCKER_SHARE_ROOT="$PWD"
    fi
    echo "[INFO] Sharing ${DOCKER_SHARE_ROOT} with the docker container."
}

claude() {
    set_docker_share_root_env

    docker run --rm -it \
        -e "IS_SANDBOX=1" \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.claude:/root/.claude" \
        -v "$HOME/.claude.json:/root/.claude.json" \
        -v "$HOME/.claude.json.backup:/root/.claude.json.backup" \
        -v "$HOME/.claude-flow:/root/.claude-flow" \
        "ryanjarv/claude" \
        "--dangerously-skip-permissions" \
        "$@"
}

claude.shell() {
    set_docker_share_root_env

    docker run --rm -it \
        -e "IS_SANDBOX=1" \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.claude:/root/.claude" \
        -v "$HOME/.claude.json:/root/.claude.json" \
        -v "$HOME/.claude.json.backup:/root/.claude.json.backup" \
        -v "$HOME/.claude-flow:/root/.claude-flow" \
        --entrypoint bash \
        "ryanjarv/claude"
}

ruv-swarm() {
    set_docker_share_root_env

    docker run --rm -it \
        -e "IS_SANDBOX=1" \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.claude:/root/.claude" \
        -v "$HOME/.claude.json:/root/.claude.json" \
        -v "$HOME/.claude.json.backup:/root/.claude.json.backup" \
        -v "$HOME/.claude-flow:/root/.claude-flow" \
        --entrypoint "/usr/bin/ruv-swarm" \
        "ryanjarv/claude" "$@"
}

claude-flow() {
    set_docker_share_root_env

    docker run --rm -it \
        -e "IS_SANDBOX=1" \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.claude:/root/.claude" \
        -v "$HOME/.claude.json:/root/.claude.json" \
        -v "$HOME/.claude.json.backup:/root/.claude.json.backup" \
        -v "$HOME/.claude-flow:/root/.claude-flow" \
        --entrypoint "/usr/local/bin/claude-flow" \
        "ryanjarv/claude" \
        "$@"
}

codex() {
    set_docker_share_root_env

    docker run --rm -it \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.codex:/root/.codex" \
        "ryanjarv/codex" \
        --dangerously-bypass-approvals-and-sandbox \
        --search \
        "$@"
}

codex.shell() {
    set_docker_share_root_env

    docker run --rm -it \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        -v "$HOME/.codex:/root/.codex" \
        --entrypoint sh \
        "ryanjarv/codex"
}

gemini() {
    set_docker_share_root_env

    docker run --rm -it \
        -v "/tmp:/tmp" \
        -v "$DOCKER_SHARE_ROOT:$DOCKER_SHARE_ROOT" -w "$PWD" \
        "ryanjarv/gemini" \
        "$@"
}
